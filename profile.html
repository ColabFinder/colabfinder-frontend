<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Update Profile</title>
</head>
<body>
  <h1>Update Your Profile</h1>
  <form id="profile-form">
    <label>Creator Type: <input type="text" id="creator_type" required></label><br>
    <label>YouTube Followers: <input type="number" id="youtube_followers" required></label><br>
    <label>TikTok Followers: <input type="number" id="tiktok_followers" required></label><br>
    <label>Instagram Followers: <input type="number" id="instagram_followers" required></label><br>
    <label>OnlyFans Subscribers: <input type="number" id="onlyfans_subscribers" required></label><br>
    <label>Niches: <input type="text" id="niches" required></label><br>
    <label>Short Bio: <textarea id="short_bio" required></textarea></label><br>
    <label>Preferred Collabs: <input type="text" id="preferred_collabs" required></label><br>
    <button type="submit">Save</button>
  </form>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const supabaseUrl = 'https://eqpmbcbaqgdmrhwmvlya.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVxcG1iY2JhcWdkbXJod212bHlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ4NDg4ODQsImV4cCI6MjA2MDQyNDg4NH0.V3SwBCiBkGO_YxTKnE7jbdFthmXAJNbiEVcjsLUYCaM';
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    document.getElementById('profile-form').addEventListener('submit', async (e) => {
      e.preventDefault();

      const { data: { user } } = await supabase.auth.getUser();
      if (!user) {
        alert("Please log in first.");
        return;
      }

      const profileData = {
        creator_type: document.getElementById('creator_type').value,
        youtube_followers: +document.getElementById('youtube_followers').value,
        tiktok_followers: +document.getElementById('tiktok_followers').value,
        instagram_followers: +document.getElementById('instagram_followers').value,
        onlyfans_subscribers: +document.getElementById('onlyfans_subscribers').value,
        niches: document.getElementById('niches').value,
        short_bio: document.getElementById('short_bio').value,
        preferred_collabs: document.getElementById('preferred_collabs').value
      };

      const { error } = await supabase
        .from('profiles')
        .upsert({ id: user.id, ...profileData });

      if (error) {
        console.error(error);
        alert("Failed to save profile.");
      } else {
        alert("Profile saved!");
        window.location.href = 'dashboard.html';
      }
    });
  </script>
</body>
</html>
