<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Set Up Your Profile</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.5.0/dist/umd/supabase.js"></script>
</head>
<body>

    <div class="profile-setup">
        <h2>Set Up Your Profile</h2>
        <form id="profile-form">
            <label for="creator-type">Creator Type</label>
            <select id="creator-type">
                <option value="YouTuber">YouTuber</option>
                <option value="TikToker">TikToker</option>
                <option value="Instagrammer">Instagrammer</option>
                <option value="OnlyFans">OnlyFans</option>
            </select>

            <label for="youtube-followers">YouTube Followers</label>
            <input type="number" id="youtube-followers" placeholder="e.g. 10000">

            <label for="tiktok-followers">TikTok Followers</label>
            <input type="number" id="tiktok-followers" placeholder="e.g. 5000">

            <label for="instagram-followers">Instagram Followers</label>
            <input type="number" id="instagram-followers" placeholder="e.g. 15000">

            <label for="onlyfans-subscribers">OnlyFans Subscribers</label>
            <input type="number" id="onlyfans-subscribers" placeholder="e.g. 200">

            <label for="niches">Niches (comma separated)</label>
            <input type="text" id="niches" placeholder="e.g. fitness, gaming, adult">

            <label for="short-bio">Short Bio</label>
            <textarea id="short-bio" placeholder="Tell others about yourself"></textarea>

            <label for="preferred-collabs">Preferred Collabs (comma separated)</label>
            <input type="text" id="preferred-collabs" placeholder="e.g. promo swap, shoutout">

            <button type="button" id="save-profile">Save Profile</button>
        </form>
    </div>

    <script>
        // Initialize Supabase
        const supabaseUrl = 'https://eqpmbcbaqgdmrhwmvlya.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVxcG1iY2JhcWdkbXJod212bHlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ4NDg4ODQsImV4cCI6MjA2MDQyNDg4NH0.V3SwBCiBkGO_YxTKnE7jbdFthmXAJNbiEVcjsLUYCaM';
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        // Debugging: Check supabase object
        console.log(supabase);

        // Function to save profile
        async function saveProfile() {
            console.log('Save profile button clicked');  // Debugging step
            const creatorType = document.getElementById('creator-type').value;
            const youtubeFollowers = document.getElementById('youtube-followers').value;
            const tiktokFollowers = document.getElementById('tiktok-followers').value;
            const instagramFollowers = document.getElementById('instagram-followers').value;
            const onlyfansSubscribers = document.getElementById('onlyfans-subscribers').value;
            const niches = document.getElementById('niches').value;
            const shortBio = document.getElementById('short-bio').value;
            const preferredCollabs = document.getElementById('preferred-collabs').value;

            // Debugging: Output the collected values to the console
            console.log({
                creatorType,
                youtubeFollowers,
                tiktokFollowers,
                instagramFollowers,
                onlyfansSubscribers,
                niches,
                shortBio,
                preferredCollabs
            });

            // Insert profile data into Supabase
            const { data, error } = await supabase
                .from('profiles')
                .upsert([
                    {
                        creator_type: creatorType,
                        youtube_followers: youtubeFollowers,
                        tiktok_followers: tiktokFollowers,
                        instagram_followers: instagramFollowers,
                        onlyfans_subscribers: onlyfansSubscribers,
                        niches: niches,
                        short_bio: shortBio,
                        preferred_collabs: preferredCollabs,
                    },
                ]);

            if (error) {
                alert('Error saving profile: ' + error.message);
            } else {
                alert('Profile saved successfully!');
            }
        }

        // Event listener for Save Profile button
        document.getElementById('save-profile').addEventListener('click', function(event) {
            event.preventDefault();  // Prevent form submission
            saveProfile();
        });
    </script>

</body>
</html>
