<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>View Profile</title>
  <!-- Optional CSS link ‚Äì only include if you have styles.css -->
  <!-- <link rel="stylesheet" href="styles.css" /> -->
</head>
<body>
  <h1>üë§ Profile</h1>
  <div>
    <p><strong>Full Name:</strong> <span id="full-name"></span></p>
    <p><strong>Username:</strong> <span id="username"></span></p>
    <p><strong>Email:</strong> <span id="email"></span></p>
    <p><strong>Creator Type:</strong> <span id="creator-type"></span></p>
    <p><strong>Bio:</strong> <span id="bio"></span></p>
  </div>
  <button onclick="logout()">Logout</button>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    const supabaseUrl = 'https://eqpmbcbaqgdmrhwmvlya.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVxcG1iY2JhcWdkbXJod213bmx5YSIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNzEzMTU4NzYyLCJleHAiOjE3NDg3MzQ3NjJ9.McQExfAFmdwMJKHBOqbdZK_kHDKmrJkR0MrAX2QbOdg';
    const supabase = createClient(supabaseUrl, supabaseKey);

    async function fetchProfile() {
      const {
        data: { user },
        error: userError
      } = await supabase.auth.getUser();

      if (userError || !user) {
        console.error('Error getting user:', userError?.message || 'Not logged in');
        window.location.href = 'index.html'; // Redirect to login
        return;
      }

      const { data: profile, error } = await supabase
        .from('profiles')
        .select('*')
        .eq('id', user.id)
        .single();

      if (error) {
        console.error('‚ùå Error fetching profile:', error.message);
      } else {
        console.log('‚úÖ Profile fetched:', profile);
        document.getElementById('full-name').textContent = profile.full_name || '';
        document.getElementById('username').textContent = profile.username || '';
        document.getElementById('email').textContent = profile.email || '';
        document.getElementById('creator-type').textContent = profile.creator_type || '';
        document.getElementById('bio').textContent = profile.bio || '';
      }
    }

    fetchProfile();

    async function logout() {
      await supabase.auth.signOut();
      window.location.href = 'index.html';
    }
  </script>
</body>
</html>
