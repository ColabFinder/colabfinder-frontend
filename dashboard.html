<!-- Load Supabase library first -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- Then your Supabase client -->
<script src="supabaseClient.js"></script>

<!-- Finally, your dashboard logic -->
<script>
  document.addEventListener("DOMContentLoaded", async () => {
    const { data: { session } } = await supabase.auth.getSession();
    if (!session) {
      window.location.href = "login.html";
      return;
    }

    const user = session.user;
    document.getElementById("user-email").innerText = user.email;

    const { data: collabs, error } = await supabase
      .from("collaborations")
      .select("*")
      .eq("user_id", user.id);

    if (error) {
      console.error("Error loading collaborations:", error.message);
    } else {
      const container = document.getElementById("collaborations-container");
      container.innerHTML = "";
      if (collabs.length === 0) {
        container.innerHTML = "<p>No collaborations found.</p>";
      } else {
        collabs.forEach((collab) => {
          const div = document.createElement("div");
          div.innerHTML = `
            <h3>${collab.title}</h3>
            <p>${collab.description}</p>
            <p><strong>Type:</strong> ${collab.type}</p>
            <hr/>
          `;
          container.appendChild(div);
        });
      }
    }
  });
</script>
